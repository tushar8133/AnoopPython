import numpy as np
from scipy.signal import savgol_filter
import matplotlib.pyplot as plt

# Noisy data
y = np.array([-5715.75, -5592.3 , -5548.33, -5638.97, -5586.43, -5703.21,
       -5660.6 , -5714.96, -5637.59, -5599.72, -5631.14, -5684.31,
       -5586.08, -5617.43, -5629.58, -5530.08, -5540.53, -5475.53,
       -5505.21, -5500.96, -5500.58, -5474.65, -5462.45, -5443.82,
       -5441.77, -5463.53, -5512.18, -5395.85, -5389.87, -5432.94,
       -5366.31, -5284.45, -5176.52, -5221.89, -5182.52, -5084.92,
       -5084.3 , -4972.78, -4968.32, -4818.19, -4789.56, -4872.02,
       -4809.45, -4855.06, -4806.77, -4717.93, -4741.29, -4822.45,
       -4760.51, -4698.31, -4744.1 , -4797.08, -4777.43, -4785.02,
       -4687.61, -4820.73, -4753.5 , -4777.99, -4812.5 , -4856.53,
       -4859.69, -4905.37, -4838.71, -5058.49, -5053.58, -5057.  ,
       -5159.58, -5155.03, -5079.21, -5228.57, -5257.26, -5409.64,
       -5505.87, -5511.82, -5471.4 , -5478.47, -5530.9 , -5578.88,
       -5705.87, -5633.66, -5740.72, -5760.05, -5801.39, -5808.52,
       -5803.22, -5832.76, -5867.51, -5837.56, -5923.97, -5933.75,
       -5945.04, -5932.16, -5909.68, -5951.29, -5958.6 , -5958.07,
       -5970.75, -5931.93, -5947.53, -5956.36])
x = np.linspace(0., 6, 100)

x = [9.0, 9.017, 9.034, 9.051, 9.068, 9.085, 9.102, 9.119, 9.136, 9.153, 9.17, 9.187, 9.204, 9.221, 9.238, 9.255, 9.272, 9.289, 9.306, 9.323, 9.34, 9.357, 9.374, 9.391, 9.408, 9.425, 9.442, 9.459, 9.476, 9.493, 9.51, 9.527, 9.544, 9.561, 9.578, 9.595, 9.612, 9.629, 9.646, 9.663, 9.68, 9.697, 9.714, 9.731, 9.748, 9.765, 9.782, 
9.799, 9.816, 9.833, 9.85, 9.867, 9.884, 9.901, 9.918, 9.935, 9.952, 9.969, 9.986, 10.003, 10.02, 10.037, 10.054, 10.071, 10.088, 10.105, 10.122, 10.139, 10.156, 10.173, 10.19, 10.207, 10.224, 10.241, 10.258, 10.275, 10.292, 10.309, 10.326, 10.343, 10.36, 10.377, 10.394, 10.411, 10.428, 10.445, 10.462, 10.479, 10.496, 10.513, 10.53, 10.547, 10.564, 10.581, 10.598, 10.615, 10.632, 10.649, 10.666, 10.683, 10.7, 10.717, 10.734, 10.751, 10.768, 10.785, 10.802, 10.819, 10.836, 10.853, 10.87, 10.887, 10.904, 10.921, 10.938, 10.955, 10.972, 10.989, 11.006, 11.023, 11.04, 11.057, 11.074, 11.091, 11.108, 11.125, 11.142, 11.159, 11.176, 11.193, 11.21, 11.227, 11.244, 11.261, 11.278, 11.295, 11.312, 11.329, 11.346, 11.363, 11.38, 11.397, 11.414, 11.431, 11.448, 11.465, 11.482, 11.499, 11.516, 11.533, 11.55, 11.567, 11.584, 11.601, 11.618, 11.635, 11.652, 11.669, 11.686, 11.703, 11.72, 11.737, 11.754, 11.771, 11.788, 11.805, 11.822, 11.839, 11.856, 11.873, 11.89, 11.907, 11.924, 11.941, 
11.958, 11.975, 11.992, 12.009, 12.026, 12.043, 12.06, 12.077, 12.094, 12.111, 12.128, 12.145, 12.162, 12.179, 12.196, 12.213, 12.23, 12.247, 12.264, 12.281, 12.298, 12.315, 12.332, 12.349, 12.366, 12.383, 12.4]

y = [2.6509324178283045, 4.717219422605937, 7.14552520155161, 10.170156859446998, 11.808677210775333, 8.734509802001392, 5.500137259212465, 2.3891831126240817, 0.7552752446516745, 1.9586650917897592, 4.346945805550947, 7.378247528021457, 9.458184078891872, 11.487985346014208, 9.100748112858975, 5.86415542752428, 3.1836881291820807, 1.4428354826776142, 1.0220562061542273, 3.6890793562829653, 6.689560303418659, 8.192537374328811, 10.339796393824455, 8.61028709509172, 6.697419307589949, 3.853018989014394, 2.0373540084262856, 0.9634474287175256, 3.4718209020546125, 5.524575784806561, 7.092365532635103, 9.43039612146141, 9.309683034424863, 6.961200164864019, 4.693136986288901, 2.426290692769815, 0.5628619059630755, 2.8240101696333704, 4.736293704610537, 6.813803730169996, 9.02306949870099, 9.98046779580188, 7.846646968174858, 5.737747341431455, 3.1269748753363262, 0.5699495348882022, 1.9121913257862717, 4.560389446739138, 6.579364402085139, 9.174638521591097, 10.440442476561845, 8.15287023132517, 5.155473660514504, 3.1903548517241993, 0.28838479871752937, 1.6905677747321959, 4.653860130390872, 6.383709344044283, 8.006817603628315, 8.657513803513961, 8.51048193936814, 5.7125886050387376, 3.6576420315973617, 1.19315122746833, 1.5922006953491823, 4.173783867791457, 6.205558569201093, 8.216846550880897, 8.621689054402356, 6.457347469110662, 5.282195537823655, 2.918203338658673, 0.5259782312385314, 2.151490840170215, 4.926147203113484, 5.775589648787616, 8.091423000583086, 8.577069837773665, 7.615306993070469, 5.502304979273668, 4.144739927597216, 1.5461423806971815, 1.0832801249263555, 3.090185142853944, 5.450887683725943, 8.78521308646132, 7.287915413653191, 6.0186821998010664, 4.537017510347982, 2.1027913834935976, 0.3778589224987615, 1.7132612694208709, 2.769268023167206, 4.431635852747959, 8.3749373474704, 7.864236704417992, 5.8610038427480315, 5.570550338383817, 1.8102853069220812, 0.3749853788196388, 0.36395778615378904, 2.0652215375016234, 3.5743952494140476, 5.35452384636267, 7.538318129727495, 2.049567613647619, 3.543796998697351, 5.306492430546572, 7.46757867336556, 8.431823742803438, 6.196256711123015, 3.87086695828917, 1.5908865256189366, 0.42545165717366507, 1.5810315591521154, 3.298148491611194, 5.534248266863905, 7.05386249390887, 8.30051875552001, 6.554237124159294, 4.188176222590158, 2.205727660297653, 0.9357905148788245, 0.883609925159937, 2.8574591940342415, 5.076957606542285, 6.205884676280586, 7.815125141111697, 6.308331458706654, 4.829836793927414, 2.7509319175100613, 1.3910414438284493, 0.8420412042073917, 2.723184878128483, 4.260274868074402, 5.433243325020066, 7.214632178564721, 6.872507425601291, 5.103120959361384, 3.4113124971459343, 1.701593675734417, 0.5456455791115787, 2.2569124858399348, 3.697972077437729, 5.275682727346552, 6.956972661260043, 7.448698569606741, 5.832386705877223, 4.229630281693409, 2.2629907725906313, 0.30903423387444157, 1.5718914091112306, 3.604759057022069, 5.13043386587702, 7.146959857871551, 7.854177431977333, 6.125631014286115, 3.832852146244066, 2.3298879022271164, 0.10493584009872196, 1.41938444413344, 3.689653458643872, 5.024270129559754, 6.3245815748792, 6.548855669709025, 6.450374443653753, 4.310749604520541, 2.7083426321971307, 0.8071921646282166, 1.342497356244822, 3.349745599393379, 4.928010127643539, 6.514739643465003, 6.555917810948266, 4.8931652607784395, 4.002413643943374, 2.162222537628897, 0.5154436870269791, 1.7935897386837187, 3.95277297144454, 4.626197358841344, 6.479220666874901, 6.76941098234221, 5.82278656372635, 4.22114052105895, 3.1408184351608863, 1.1083229521096252, 0.9621802394213568, 2.5337121838578858, 4.398278251503968, 7.094233058773224, 5.625791272931282, 4.648754412915359, 3.4713271309721394, 1.5587783274403737, 0.19338540494322057, 1.4637799024093556, 2.2919536000679632, 3.611592859840087, 6.369257431099312, 6.0766321154167855]

# Smoothed data

plt.plot(x, y)



yhat = savgol_filter(y, 70, 1)
plt.plot(x, yhat, color='r')

'''
from scipy.signal import butter, filtfilt

def butter_lowpass(cutoff, fs, order=5):
    nyq = 0.5 * fs
    normal_cutoff = cutoff / nyq
    b, a = butter(order, normal_cutoff, btype='low', analog=False)
    return b, a

def butter_lowpass_filtfilt(data, cutoff, fs, order=5):
    b, a = butter_lowpass(cutoff, fs, order=order)
    y = filtfilt(b, a, data)
    return y

# pressure = data[:,1]
cutoff = 1500
fs = 50000
pressure_smooth = butter_lowpass_filtfilt(y, cutoff, fs)
plt.plot(x, pressure_smooth, color='g')
'''



plt.show()
